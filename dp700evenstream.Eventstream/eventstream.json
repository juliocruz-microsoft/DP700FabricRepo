{
  "sources": [
    {
      "id": "eb532b55-8ead-41d6-bef9-b94393654155",
      "name": "iothub",
      "type": "AzureIoTHub",
      "properties": {
        "dataConnectionId": "cf3c598e-7ac8-4f5e-a476-ed8446beee64",
        "consumerGroupName": "$Default",
        "inputSerialization": {
          "type": "Json",
          "properties": {
            "encoding": "UTF8"
          }
        }
      }
    }
  ],
  "destinations": [
    {
      "id": "45642d03-7036-4635-91ee-8230897dacb6",
      "name": "RawDataEventhouse",
      "type": "Eventhouse",
      "properties": {
        "dataIngestionMode": "ProcessedIngestion",
        "workspaceId": "00000000-0000-0000-0000-000000000000",
        "itemId": "831e3668-2cc2-b1c7-411d-143e50575d91",
        "databaseName": "dp700eventhouse",
        "tableName": "iotrawdata",
        "inputSerialization": {
          "type": "Json",
          "properties": {
            "encoding": "UTF8"
          }
        }
      },
      "inputNodes": [
        {
          "name": "dp700evenstream-stream"
        }
      ],
      "inputSchemas": [
        {
          "name": "dp700evenstream-stream",
          "schema": {
            "columns": [
              {
                "name": "messageId",
                "type": "BigInt",
                "fields": null,
                "items": null
              },
              {
                "name": "deviceId",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "temperature",
                "type": "Float",
                "fields": null,
                "items": null
              },
              {
                "name": "humidity",
                "type": "Float",
                "fields": null,
                "items": null
              },
              {
                "name": "EventProcessedUtcTime",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "PartitionId",
                "type": "BigInt",
                "fields": null,
                "items": null
              },
              {
                "name": "EventEnqueuedUtcTime",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "IoTHub",
                "type": "Record",
                "fields": [
                  {
                    "name": "MessageId",
                    "type": "Record",
                    "fields": [],
                    "items": null
                  },
                  {
                    "name": "CorrelationId",
                    "type": "Record",
                    "fields": [],
                    "items": null
                  },
                  {
                    "name": "ConnectionDeviceId",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "ConnectionDeviceGenerationId",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "EnqueuedTime",
                    "type": "DateTime",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "StreamId",
                    "type": "Record",
                    "fields": [],
                    "items": null
                  }
                ],
                "items": null
              }
            ]
          }
        }
      ]
    },
    {
      "id": "68d95f77-dc6a-40f5-92e5-7cf088f6e088",
      "name": "Temp30",
      "type": "Eventhouse",
      "properties": {
        "dataIngestionMode": "ProcessedIngestion",
        "workspaceId": "00000000-0000-0000-0000-000000000000",
        "itemId": "831e3668-2cc2-b1c7-411d-143e50575d91",
        "databaseName": "dp700eventhouse",
        "tableName": "Temp30mais",
        "inputSerialization": {
          "type": "Json",
          "properties": {
            "encoding": "UTF8"
          }
        }
      },
      "inputNodes": [
        {
          "name": "Filter"
        }
      ],
      "inputSchemas": [
        {
          "name": "Filter",
          "schema": {
            "columns": [
              {
                "name": "current_time",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "messageId",
                "type": "BigInt",
                "fields": null,
                "items": null
              },
              {
                "name": "deviceId",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "temperature",
                "type": "Float",
                "fields": null,
                "items": null
              },
              {
                "name": "humidity",
                "type": "Float",
                "fields": null,
                "items": null
              },
              {
                "name": "EventProcessedUtcTime",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "PartitionId",
                "type": "BigInt",
                "fields": null,
                "items": null
              },
              {
                "name": "EventEnqueuedUtcTime",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "IoTHub",
                "type": "Record",
                "fields": [
                  {
                    "name": "MessageId",
                    "type": "Record",
                    "fields": [],
                    "items": null
                  },
                  {
                    "name": "CorrelationId",
                    "type": "Record",
                    "fields": [],
                    "items": null
                  },
                  {
                    "name": "ConnectionDeviceId",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "ConnectionDeviceGenerationId",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "EnqueuedTime",
                    "type": "DateTime",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "StreamId",
                    "type": "Record",
                    "fields": [],
                    "items": null
                  }
                ],
                "items": null
              }
            ]
          }
        }
      ]
    }
  ],
  "streams": [
    {
      "id": "fa001678-b3be-443f-86b9-8c0d399bd4cd",
      "name": "dp700evenstream-stream",
      "type": "DefaultStream",
      "properties": {},
      "inputNodes": [
        {
          "name": "iothub"
        }
      ]
    }
  ],
  "operators": [
    {
      "name": "Filter",
      "type": "Filter",
      "inputNodes": [
        {
          "name": "ManageFields"
        }
      ],
      "properties": {
        "conditions": [
          {
            "column": {
              "expressionType": "ColumnReference",
              "node": null,
              "columnName": "temperature",
              "columnPathSegments": []
            },
            "operatorType": "GreaterThanOrEquals",
            "value": {
              "expressionType": "Literal",
              "dataType": "Float",
              "value": "30"
            }
          }
        ]
      },
      "inputSchemas": [
        {
          "name": "ManageFields",
          "schema": {
            "columns": [
              {
                "name": "current_time",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "messageId",
                "type": "BigInt",
                "fields": null,
                "items": null
              },
              {
                "name": "deviceId",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "temperature",
                "type": "Float",
                "fields": null,
                "items": null
              },
              {
                "name": "humidity",
                "type": "Float",
                "fields": null,
                "items": null
              },
              {
                "name": "EventProcessedUtcTime",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "PartitionId",
                "type": "BigInt",
                "fields": null,
                "items": null
              },
              {
                "name": "EventEnqueuedUtcTime",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "IoTHub",
                "type": "Record",
                "fields": [
                  {
                    "name": "MessageId",
                    "type": "Record",
                    "fields": [],
                    "items": null
                  },
                  {
                    "name": "CorrelationId",
                    "type": "Record",
                    "fields": [],
                    "items": null
                  },
                  {
                    "name": "ConnectionDeviceId",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "ConnectionDeviceGenerationId",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "EnqueuedTime",
                    "type": "DateTime",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "StreamId",
                    "type": "Record",
                    "fields": [],
                    "items": null
                  }
                ],
                "items": null
              }
            ]
          }
        }
      ]
    },
    {
      "name": "ManageFields",
      "type": "ManageFields",
      "inputNodes": [
        {
          "name": "dp700evenstream-stream"
        }
      ],
      "properties": {
        "columns": [
          {
            "type": "FunctionCall",
            "properties": {
              "functionName": "SystemTimestamp",
              "arguments": []
            },
            "alias": "current_time"
          },
          {
            "type": "Rename",
            "properties": {
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "messageId",
                "columnPathSegments": []
              }
            },
            "alias": "messageId"
          },
          {
            "type": "Rename",
            "properties": {
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "deviceId",
                "columnPathSegments": []
              }
            },
            "alias": "deviceId"
          },
          {
            "type": "Rename",
            "properties": {
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "temperature",
                "columnPathSegments": []
              }
            },
            "alias": "temperature"
          },
          {
            "type": "Rename",
            "properties": {
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "humidity",
                "columnPathSegments": []
              }
            },
            "alias": "humidity"
          },
          {
            "type": "Rename",
            "properties": {
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "EventProcessedUtcTime",
                "columnPathSegments": []
              }
            },
            "alias": "EventProcessedUtcTime"
          },
          {
            "type": "Rename",
            "properties": {
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "PartitionId",
                "columnPathSegments": []
              }
            },
            "alias": "PartitionId"
          },
          {
            "type": "Rename",
            "properties": {
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "EventEnqueuedUtcTime",
                "columnPathSegments": []
              }
            },
            "alias": "EventEnqueuedUtcTime"
          },
          {
            "type": "Rename",
            "properties": {
              "column": {
                "expressionType": "ColumnReference",
                "node": null,
                "columnName": "IoTHub",
                "columnPathSegments": []
              }
            },
            "alias": "IoTHub"
          }
        ]
      },
      "inputSchemas": [
        {
          "name": "dp700evenstream-stream",
          "schema": {
            "columns": [
              {
                "name": "messageId",
                "type": "BigInt",
                "fields": null,
                "items": null
              },
              {
                "name": "deviceId",
                "type": "Nvarchar(max)",
                "fields": null,
                "items": null
              },
              {
                "name": "temperature",
                "type": "Float",
                "fields": null,
                "items": null
              },
              {
                "name": "humidity",
                "type": "Float",
                "fields": null,
                "items": null
              },
              {
                "name": "EventProcessedUtcTime",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "PartitionId",
                "type": "BigInt",
                "fields": null,
                "items": null
              },
              {
                "name": "EventEnqueuedUtcTime",
                "type": "DateTime",
                "fields": null,
                "items": null
              },
              {
                "name": "IoTHub",
                "type": "Record",
                "fields": [
                  {
                    "name": "MessageId",
                    "type": "Record",
                    "fields": [],
                    "items": null
                  },
                  {
                    "name": "CorrelationId",
                    "type": "Record",
                    "fields": [],
                    "items": null
                  },
                  {
                    "name": "ConnectionDeviceId",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "ConnectionDeviceGenerationId",
                    "type": "Nvarchar(max)",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "EnqueuedTime",
                    "type": "DateTime",
                    "fields": null,
                    "items": null
                  },
                  {
                    "name": "StreamId",
                    "type": "Record",
                    "fields": [],
                    "items": null
                  }
                ],
                "items": null
              }
            ]
          }
        }
      ]
    }
  ],
  "compatibilityLevel": "1.1"
}